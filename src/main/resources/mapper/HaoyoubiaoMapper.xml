<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.com.yuyang.pojo.HaoyoubiaoMapper">
    <select id="chaXunTongXunLu" resultMap="getOneToOneMao">
        select dl.shouJiHaoMa,ry.jinJiLianXiDianHua,ry.xingMing,bm.buMenMingCheng
        from denglu as dl
                 join renyuandangan as ry
                 join bumen as bm on
                    dl.dangAnId = ry.id and
                    ry.buMenId = bm.id and
                    dl.shouJiHaoMa in (select shouJiHaoMa
                                       from denglu as dl
                                       where dangAnId in
                                             (select hy.haoYouId
                                              from haoyoubiao as hy
                                                       join denglu as dl on hy.benRenId = dl.dangAnId and dl.dangAnId = #{dangAnId}));
    </select>
    <resultMap id="getOneToOneMao" type="cn.com.yuyang.pojo.Haoyoubiao">
        <id property="id" column="id1"/>
        <result property="benRenId" column="benRenId"/>
        <result property="haoYouId" column="haoYouId"/>
        <association property="dengLu" javaType="cn.com.yuyang.pojo.Denglu">
            <id property="id" column="id2"/>
            <result property="dangAnId" column="dangAnId"/>
            <result property="shouJiHaoMa" column="shouJiHaoMa"/>
        </association>
        <association property="renyuandangan" javaType="cn.com.yuyang.pojo.Renyuandangan">
            <id property="id" column="id"/>
            <result property="jinJiLianXiDianHua" column="jinJiLianXiDianHua"/>
            <result property="xingMing" column="xingMing"/>
            <association property="bumen" javaType="cn.com.yuyang.pojo.Bumen">
                <id property="id" column="id3"/>
                <result property="buMenMingCheng" column="buMenMingCheng"/>
            </association>
        </association>
    </resultMap>
</mapper>