<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.com.yuyang.pojo.XinxiMapper">
    <select id="selectAll" resultType="cn.com.yuyang.bean.XinXiBean" parameterType="java.lang.Integer">
        select x.faXinId,(SELECT renyuandangan.xingMing from renyuandangan where
            x.faXinId=renyuandangan.id)as faJianRenXingMing,x.xinXiBiaoTi,x.faSongZhuangTai,
               x.shouXinId, (select renyuandangan.xingMing from renyuandangan where
            x.shouXinId =renyuandangan.id) as shouJianRenXingMing, x.xinXiNeiRong,
               x.xinXiShiJian,x.fuJianDiZhi,x.id,x.shouCangZhuangTai from xinxi x where x.shouXinId =#{id}
                                                                                    and x.zhuangTai =1 and x.faSongZhuangTai=1;
    </select>


    <select id="selectByParam" resultType="cn.com.yuyang.bean.XinXiBean" parameterType="cn.com.yuyang.bean.XinXiSouSuoBean">
        select x.faXinId,(SELECT renyuandangan.xingMing from renyuandangan where
        x.faXinId=renyuandangan.id)as faJianRenXingMing,x.xinXiBiaoTi,x.faSongZhuangTai,
        x.shouXinId, (select renyuandangan.xingMing from renyuandangan where
        x.shouXinId =renyuandangan.id) as shouJianRenXingMing, x.xinXiNeiRong,
        x.xinXiShiJian,x.fuJianDiZhi,x.id,x.shouCangZhuangTai from xinxi x where x.shouXinId =#{id}
        and x.zhuangTai =1 and x.faSongZhuangTai=1
        <if test="riQi != null and riQi!=''">
            and x.xinXiShiJian like concat(concat('%',#{riQi},'%'),'%')
        </if>
        <if test="guanJianCi != null and guanJianCi!='' ">
            and x.xinXiBiaoTi like concat(concat('%',#{guanJianCi},'%'),'%') or
            x.xinXiNeiRong like concat(concat('%',#{guanJianCi},'%'),'%')
        </if>

    </select>
</mapper>